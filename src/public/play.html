<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HFlow API Playground</title>
  <!-- Tailwind CSS + Flowbite CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'oxford-blue': '#050D2A',
            'electric-blue': '#00A3FF',
            'cyber-teal': '#00F5D4',
            'neon-cyan': '#0FF0FC',
            'midnight-navy': '#0A1435',
          },
          backgroundImage: {
            'gradient-tech': 'linear-gradient(45deg, #00A3FF 0%, #00F5D4 100%)',
          }
        }
      }
    }
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #050D2A;
      color: #E0E5EC;
    }
    .api-card {
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
    }
    .api-card:hover {
      border-left-color: #00A3FF;
    }
    .response-area {
      font-family: monospace;
      min-height: 200px;
    }
    .tab-active {
      border-bottom: 3px solid #00A3FF;
    }
  </style>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="min-h-screen">
  <!-- Navbar -->
  <nav class="bg-midnight-navy border-b border-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16 items-center">
        <div class="flex items-center">
          <span class="text-2xl font-bold bg-gradient-to-r from-electric-blue to-cyber-teal bg-clip-text text-transparent">HFLOW API PLAYGROUND</span>
        </div>
        <div class="hidden md:block">
          <div class="ml-10 flex items-center space-x-4">
            <a href="index.html" class="hover:text-cyber-teal px-3 py-2">Back to App</a>
            <a href="*384*2005#" class="ml-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-full">
              Dial *384*2005#
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h1 class="text-3xl md:text-4xl font-bold mb-4">HFlow API Playground</h1>
        <p class="text-xl text-gray-300 max-w-3xl mx-auto">
          Test and interact with HFlow's backend API endpoints
        </p>
      </div>

      <!-- Tabs -->
      <div class="flex border-b border-gray-700 mb-8">
        <button class="tab-button px-6 py-3 font-medium text-electric-blue tab-active" data-tab="user">User API</button>
        <button class="tab-button px-6 py-3 font-medium text-gray-400" data-tab="transaction">Transaction API</button>
        <button class="tab-button px-6 py-3 font-medium text-gray-400" data-tab="admin">Admin API</button>
      </div>

      <!-- User API Section -->
      <div id="user-tab" class="tab-content">
        <!-- Register User -->
        <div class="api-card bg-midnight-navy rounded-lg p-6 mb-8">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-gradient-tech rounded-full flex items-center justify-center mr-4 text-oxford-blue font-bold">POST</div>
            <h3 class="text-xl font-bold">/api/user/register</h3>
            <span class="ml-auto bg-green-900 text-green-400 text-xs px-2 py-1 rounded">Public</span>
          </div>
          <p class="text-gray-400 mb-6">Register a new user with phone number and PIN</p>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Request Body</h4>
              <textarea id="register-input" class="w-full bg-gray-800 border border-gray-700 text-white text-sm rounded-lg p-4 h-48">
{
  "phone": "+254712345678",
  "fullName": "John Doe",
  "pin": "1234"
}</textarea>
            </div>
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Response</h4>
              <div id="register-response" class="response-area w-full bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg p-4 overflow-auto"></div>
            </div>
          </div>
          <button onclick="testEndpoint('register')" class="mt-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-lg">
            Test Endpoint
          </button>
        </div>

        <!-- Get User -->
        <div class="api-card bg-midnight-navy rounded-lg p-6 mb-8">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-blue-900 rounded-full flex items-center justify-center mr-4 text-blue-400 font-bold">GET</div>
            <h3 class="text-xl font-bold">/api/user/{phone}</h3>
            <span class="ml-auto bg-yellow-900 text-yellow-400 text-xs px-2 py-1 rounded">Protected</span>
          </div>
          <p class="text-gray-400 mb-6">Retrieve user details by phone number</p>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Parameters</h4>
              <div class="bg-gray-800 border border-gray-700 rounded-lg p-4">
                <div class="mb-3">
                  <label class="block text-sm text-gray-400 mb-1">Phone Number</label>
                  <input id="get-user-phone" type="text" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white" value="+254712345678">
                </div>
              </div>
            </div>
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Response</h4>
              <div id="get-user-response" class="response-area w-full bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg p-4 overflow-auto"></div>
            </div>
          </div>
          <button onclick="testEndpoint('get-user')" class="mt-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-lg">
            Test Endpoint
          </button>
        </div>
      </div>

      <!-- Transaction API Section (hidden by default) -->
      <div id="transaction-tab" class="tab-content hidden">
        <!-- Create Transaction -->
        <div class="api-card bg-midnight-navy rounded-lg p-6 mb-8">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-gradient-tech rounded-full flex items-center justify-center mr-4 text-oxford-blue font-bold">POST</div>
            <h3 class="text-xl font-bold">/api/transaction/new</h3>
            <span class="ml-auto bg-yellow-900 text-yellow-400 text-xs px-2 py-1 rounded">Protected</span>
          </div>
          <p class="text-gray-400 mb-6">Create a new HBAR transaction between users</p>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Request Body</h4>
              <textarea id="transaction-input" class="w-full bg-gray-800 border border-gray-700 text-white text-sm rounded-lg p-4 h-48">
{
  "senderPhone": "+254712345678",
  "receiverPhone": "+254798765432",
  "amount": 10,
  "pin": "1234"
}</textarea>
            </div>
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Response</h4>
              <div id="transaction-response" class="response-area w-full bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg p-4 overflow-auto"></div>
            </div>
          </div>
          <button onclick="testEndpoint('transaction')" class="mt-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-lg">
            Test Endpoint
          </button>
        </div>

        <!-- Get Transactions -->
        <div class="api-card bg-midnight-navy rounded-lg p-6">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-blue-900 rounded-full flex items-center justify-center mr-4 text-blue-400 font-bold">GET</div>
            <h3 class="text-xl font-bold">/api/transaction/{phone}</h3>
            <span class="ml-auto bg-yellow-900 text-yellow-400 text-xs px-2 py-1 rounded">Protected</span>
          </div>
          <p class="text-gray-400 mb-6">Get transaction history for a user</p>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Parameters</h4>
              <div class="bg-gray-800 border border-gray-700 rounded-lg p-4">
                <div class="mb-3">
                  <label class="block text-sm text-gray-400 mb-1">Phone Number</label>
                  <input id="get-transactions-phone" type="text" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white" value="+254712345678">
                </div>
                <div class="mb-3">
                  <label class="block text-sm text-gray-400 mb-1">Limit</label>
                  <input id="get-transactions-limit" type="number" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white" value="5">
                </div>
              </div>
            </div>
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Response</h4>
              <div id="get-transactions-response" class="response-area w-full bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg p-4 overflow-auto"></div>
            </div>
          </div>
          <button onclick="testEndpoint('get-transactions')" class="mt-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-lg">
            Test Endpoint
          </button>
        </div>
      </div>

      <!-- Admin API Section (hidden by default) -->
      <div id="admin-tab" class="tab-content hidden">
        <!-- Admin Login -->
        <div class="api-card bg-midnight-navy rounded-lg p-6 mb-8">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-gradient-tech rounded-full flex items-center justify-center mr-4 text-oxford-blue font-bold">POST</div>
            <h3 class="text-xl font-bold">/api/admin/login</h3>
            <span class="ml-auto bg-green-900 text-green-400 text-xs px-2 py-1 rounded">Public</span>
          </div>
          <p class="text-gray-400 mb-6">Authenticate as an admin user</p>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Request Body</h4>
              <textarea id="admin-login-input" class="w-full bg-gray-800 border border-gray-700 text-white text-sm rounded-lg p-4 h-48">
{
  "email": "admin@hflow.africa",
  "password": "securepassword"
}</textarea>
            </div>
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Response</h4>
              <div id="admin-login-response" class="response-area w-full bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg p-4 overflow-auto"></div>
            </div>
          </div>
          <button onclick="testEndpoint('admin-login')" class="mt-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-lg">
            Test Endpoint
          </button>
        </div>

        <!-- Get All Users -->
        <div class="api-card bg-midnight-navy rounded-lg p-6">
          <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-blue-900 rounded-full flex items-center justify-center mr-4 text-blue-400 font-bold">GET</div>
            <h3 class="text-xl font-bold">/api/admin/users</h3>
            <span class="ml-auto bg-red-900 text-red-400 text-xs px-2 py-1 rounded">Admin Only</span>
          </div>
          <p class="text-gray-400 mb-6">List all registered users (admin only)</p>
          
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Parameters</h4>
              <div class="bg-gray-800 border border-gray-700 rounded-lg p-4">
                <div class="mb-3">
                  <label class="block text-sm text-gray-400 mb-1">Limit</label>
                  <input id="get-all-users-limit" type="number" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white" value="5">
                </div>
                <div class="mb-3">
                  <label class="block text-sm text-gray-400 mb-1">Auth Token</label>
                  <input id="get-all-users-token" type="text" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white" placeholder="JWT from login">
                </div>
              </div>
            </div>
            <div>
              <h4 class="font-medium mb-2 text-gray-300">Response</h4>
              <div id="get-all-users-response" class="response-area w-full bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg p-4 overflow-auto"></div>
            </div>
          </div>
          <button onclick="testEndpoint('get-all-users')" class="mt-4 bg-gradient-tech hover:opacity-90 text-oxford-blue font-bold py-2 px-6 rounded-lg">
            Test Endpoint
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-midnight-navy py-8 border-t border-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <p class="text-gray-500 text-sm">
        Â© 2023 Hflow API Playground. For development purposes only.
      </p>
    </div>
  </footer>

  <!-- Flowbite JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
  
  <!-- API Testing Script -->
  <script>
    // Tab switching
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', () => {
        // Update tab buttons
        document.querySelectorAll('.tab-button').forEach(btn => {
          btn.classList.remove('text-electric-blue', 'tab-active');
          btn.classList.add('text-gray-400');
        });
        button.classList.add('text-electric-blue', 'tab-active');
        button.classList.remove('text-gray-400');
        
        // Update tab content
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.add('hidden');
        });
        document.getElementById(`${button.dataset.tab}-tab`).classList.remove('hidden');
      });
    });

    // Mock API responses based on your database.js
    async function testEndpoint(endpoint) {
      const responseArea = document.getElementById(`${endpoint}-response`);
      responseArea.innerHTML = 'Testing endpoint...';
      
      // Simulate API delay
      await new Promise(resolve => setTimeout(resolve, 800));
      
      switch(endpoint) {
        case 'register':
          responseArea.innerHTML = `{
  "success": true,
  "data": {
    "phone": "+254712345678",
    "hederaAccountId": "0.0.123456",
    "publicKey": "302a300506032b...",
    "message": "User registered successfully"
  }
}`;
          break;
          
        case 'get-user':
          const phone = document.getElementById('get-user-phone').value;
          responseArea.innerHTML = `{
  "success": true,
  "data": {
    "phone": "${phone}",
    "fullName": "John Doe",
    "hederaAccountId": "0.0.123456",
    "publicKey": "302a300506032b...",
    "createdAt": "${new Date().toISOString()}"
  }
}`;
          break;
          
        case 'transaction':
          responseArea.innerHTML = `{
  "success": true,
  "data": {
    "txHash": "0.0.123456@1234567890.000000000",
    "sender": "+254712345678",
    "receiver": "+254798765432",
    "amount": 10,
    "fee": 0.0001,
    "hashScanUrl": "https://hashscan.io/testnet/transaction/0.0.123456@1234567890.000000000",
    "message": "Transaction completed successfully"
  }
}`;
          break;
          
        case 'get-transactions':
          const txPhone = document.getElementById('get-transactions-phone').value;
          const limit = document.getElementById('get-transactions-limit').value;
          responseArea.innerHTML = `{
  "success": true,
  "data": [
    {
      "id": 1,
      "senderPhone": "${txPhone}",
      "receiverPhone": "+254798765432",
      "amount": 10,
      "txHash": "0.0.123456@1234567890.000000000",
      "status": "success",
      "timestamp": "${new Date().toISOString()}"
    },
    {
      "id": 2,
      "senderPhone": "+254798765432",
      "receiverPhone": "${txPhone}",
      "amount": 5,
      "txHash": "0.0.123457@1234567891.000000000",
      "status": "success",
      "timestamp": "${new Date(Date.now() - 86400000).toISOString()}"
    }
  ],
  "count": 2,
  "limit": ${limit}
}`;
          break;
          
        case 'admin-login':
          responseArea.innerHTML = `{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expiresIn": 3600,
  "admin": {
    "email": "admin@hflow.africa",
    "fullName": "Admin User"
  }
}`;
          break;
          
        case 'get-all-users':
          const userLimit = document.getElementById('get-all-users-limit').value;
          responseArea.innerHTML = `{
  "success": true,
  "data": [
    {
      "phone": "+254712345678",
      "fullName": "John Doe",
      "hederaAccountId": "0.0.123456",
      "createdAt": "${new Date().toISOString()}"
    },
    {
      "phone": "+254798765432",
      "fullName": "Jane Smith",
      "hederaAccountId": "0.0.123457",
      "createdAt": "${new Date(Date.now() - 86400000).toISOString()}"
    }
  ],
  "count": 2,
  "limit": ${userLimit}
}`;
          break;
      }
      
      // Pretty print JSON
      responseArea.innerHTML = syntaxHighlight(JSON.parse(responseArea.innerHTML));
    }
    
    // JSON syntax highlighting
    function syntaxHighlight(json) {
      if (typeof json != 'string') {
        json = JSON.stringify(json, null, 2);
      }
      json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
      return json.replace(
        /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
        function (match) {
          let cls = 'text-gray-300';
          if (/^"/.test(match)) {
            if (/:$/.test(match)) {
              cls = 'text-electric-blue';
            } else {
              cls = 'text-cyber-teal';
            }
          } else if (/true|false/.test(match)) {
            cls = 'text-neon-cyan';
          } else if (/null/.test(match)) {
            cls = 'text-purple-400';
          }
          return '<span class="' + cls + '">' + match + '</span>';
        }
      );
    }
  </script>
</body>
</html>